# 6. 네트워크 설계와 구축

## 1. 네트워크 설계, 구축을 할 때 할 일

### 1-1. 시스템 개발과 네트워크 설계, 구축의 관계

- 네트워크 설계는 “그 시스템이 무엇을 하는 시스템인가?” 를 생각하는 것
- 시스템의 규모에 따라 필요한 네트워크의 형태가 달라짐
- 

### 1-2. 네트워크 설계와 구축(물리 인프라 편)

- **네트워크 설계 흐름**
    1. **요건 정의**
        
        : 어떤 시스템을 만드는가? 어떤 시스템을 위한 네트워크를 만드는가?
        
    2. **기본 설계**
        
        : 네트워크 구축에 필요한 기본 사항을 정리한다.
        
    3. **상세 설계**
        
        : 기본 설계를 바탕으로 구현 방식 등 세부 내용을 채움
        
    4. **설계 리뷰**
        
        : 관계자의 설계 내용 확인 및 피드백 반영
        
- **네트워크 구성도**
    - **물리 설계도**
        - 포트 표: 네트워크 기기가 포트별로 어디로 접속하는지 기록
        - 랙 구성도: 랙의 어느 위치에 어떤 기기를 넣을지 기록
        - 케이블 결선 표: 케이블의 접속처, 종류, 색 등의 정보 기록
    - **논리 설계도**
        - 네트워크 회선의 랜간 라우팅, 방화벽, 어드레싱 등을 실시
        - 설계한 내용을 그림으로 나타냄
        

### 1-3. 네트워크 설계와 구축(클라우드 서비스 편)

IaaS는 가상화 기반에 시스템 구축하므로 서버와 네트워크 모두 가상으로 웹 화면에서 생성

- **AWS를 통한 시스템 구축 예시**
1. ********서브넷 생성********
    
    : 퍼블릭 서브넷과 프라이빗 서브넷(DB용)을 나누어 생성
    
2. **가상 서버 생성**
    
    : EC2 서비스를 사용해 웹 서버 인스턴스 생성 및 RDS 서비스를 통해 DB 서버 인스턴스 생성
    
3. **보안 그룹 설정**
    
    : 방화벽과 유사한 기능 수행. 필요한 포트만 외부에서 보내는 통신을 통과하도록 인스턴스에 할당
    
4. **Elastic IP 설정**
    
    : 인스턴스의 고정 글로벌IP. 외부에 공개할 웹 서버 인스턴스로 설정
    
    가상화 기반에 설정하는 것이므로 물리적인 작업이 발생하지 않음
    

## 2. 웹 신뢰성을 높이는 기술

### 2-1. 웹 신뢰성이란?

**장애 대응 설계 (design for failure)**

: 시스템에 장애가 발생해도 서비스를 지속해서 제공

- **암호화**: 송수신 데이터를 타인이 읽을 수 없도록 처리
- **로드 밸런싱**: 여러 대의 서버를 가동하여 처리 배분

### 2-2. 대칭 키 암호화 방식과 공개 키 암호 방식

- **대칭 키 암호 방식**
    - 암호화와 복호화에 같은 키(대칭 키)를 이용하는 방식
    - 파일 암호화에 주로 사용
    - 흐름
        1. 수신자가 발신자에게 키를 건네주고 수신자도 같은 키를 가지고 있다
            
            (발신자별 다른 키)
            
        2. 발신자는 암호 키로 암호화한 파일을 수신자에게 보낸다
        3. 수신자는 가지고 있던 같은 키로 파일을 복호화 한다
    - 각 발신자와 공유하는 키가 달라야 함
- **공개 키 암호 방식**
    - 암호화와 복호화에 별도의 키를 사용하는 방식
    - **공개 키**: 암호화에 사용하는 것
    - **비밀 키**: 복호화에 사용하는 것
    - 흐름
        1. 수신자가 발신자에게 공개키를 건네준다 (모든 발신자에게 동일한 키)
        2. 발신자는 공개키로 암호화한 파일을 수신자에게 보낸다
        3. 수신자는 비밀 키로 파일을 복호화한다
    - 복호화 할 수 있는 건 비밀 키를 가진 사람 뿐
- **두 가지 방식을 함께 사용**
    - SSL/TLS 통신에서는 대칭 키 암호화 방식과 공개 키 암호화 방식을 함께 사용
    - SSL/TLS 흐름
        1. 클라이언트가 서버에 접속 요청
        2. 서버가 클라이언트에 공개 키를 줌
        3. 클라이언트가 통신용 대칭 키 생성
        4. 클라이언트가 공개키로 대칭 키 암호화
        5. 클라이언트가 서버에 대칭 키를 줌
        6. 서버가 비밀 키로 대칭키 복호화
        7. 대칭 키를 사용해서 암호 통신
    - SSL/TLS 인증서
        
        : SSL/TLS 통신을 시작할 때 서버가 클라이언트에 전달하는 인증 정보나 공개 키 정보를 하나로 모은 것
        

### 2-3. 상시 SSL화

: 웹 사이트 전체를 HTTPS화 하는 것

- **이점**
    - HTTP/2 에서는 속도가 빨라진다
    - SEO(Search Engine Optimization)의 장점이 있다
    - HTTP 프로토콜로 웹 사이트를 열면 브라우저에 경고 표시

### 2-4. 부하 분산

: 웹 사이트의 처리 능력 향상을 위해 웹 서버 여러 대로 웹 사이트를 호스팅 하는 경우 액세스를 분산해서 할당하는 것

- **부하 분산 방법**
    - **DNS 라운드 로빈**
        - DNS 시스템을 사용해서 요청을 서버 여러 개로 분산하는 방식
        - 한 호스트 이름에 IP를 여러 개 설정함으로 DNS 서버가 차례대로 IP 주소 반환
        - 특별한 장비나 소프트웨어를 쓰지 않고도 부하를 분산할 수 있다는 장점
        - 다운된 서버의 IP를 반환하는 경우가 있으며 서버의 처리 능력과 관계 없이 고르게 할당되는 단순한 구조임
    - **NAT 형**
        - VIP 하는 가상 IP주소에 대한 요청을 실제 서버 여러 대에 할당하는 방식
        - 일반적인 로드 밸런서(L4/L7 스위치)에서 채용하는 방식
    - **GSLB** (Global  Server Load Balancing)
        - 여러 위치를 가로 지르는 부하 분산 실현 방식
        - 장애가 발생한 서버에는 할당하지 않게 함으로써 재해나 장애를 대비

### 2-5. 리버스 프록시

- **프록시 서버**
    - 클라이언트 쪽에 설치되어 클라이언트가 웹 서버에 액세스하는 것을 중개하는 역할
- **리버스 프록시**
    - 서버 쪽에 설치되어 서버에 대한 요청을 받아 배후에 있는 서버에 넘겨주는 데 사용. 웹 서버가 받는 요청을 대신해서 받음

### 2-6. CDN (Content Delivery Network)

- 동일한 콘텐츠를 많은 배포처(클라이언트)에 효율적으로 배포할 때 사용
- 에지 서버(콘텐츠를 배포하는 서버)가 오리진 서버(원본 데이터를 가진 서버)에서 데이터 사본을 캐시로 가지고 있다가 오리진 서버를 대신에 클라이언트의 요청에 응답함
- DDoS 공격(대량의 요청을 발생시켜 서버를 다운 시키는 공격)에 대한 대책으로도 사용
- 사용 예
    - 웹 사이트의 용량이 큰 동영상 같은 콘텐츠 전송
    - 운영체제 업데이트

###